name: 'ì´ìŠˆ ìƒì„±ì‹œ ìë™ ë‹´ë‹¹ì ì§€ì •'

on:
  issues:
    types: [opened]

permissions:
  issues: write

jobs:
  self_assign:
    name: 'ğŸ“Œ ì‘ì„±ìë¥¼ ë‹´ë‹¹ìë¡œ ìë™ ì§€ì •'
    runs-on: ubuntu-latest
    steps:
      - name: 'ğŸ·ï¸ ì‘ì„±ì ì¶”ê°€ + ì„±ê³µì‹œ ëŒ“ê¸€'
        uses: actions/github-script@v7
        with:
          script: |
            const { owner, repo } = context.repo;
            const issue = context.payload.issue;
            const issue_number = issue.number;
            const author = issue.user.login;

            const assignees = Array.isArray(issue.assignees) ? issue.assignees.map(a => a.login) : [];

            // ì‘ì„±ìê°€ ì´ë¯¸ ë°°ì •ë¼ ìˆìœ¼ë©´ ë°”ë¡œ ì¢…ë£Œ
            if (assignees.includes(author)) {
              core.info(`â„¹ï¸ @${author} ì´ë¯¸ ë‹´ë‹¹ìì…ë‹ˆë‹¤. ê±´ë„ˆëœ€ (#${issue_number})`);
              return;
            }

            // ê¸°ì¡´ ë‹´ë‹¹ìëŠ” ê·¸ëŒ€ë¡œ ë‘ê³  ì‘ì„±ìë§Œ ì¶”ê°€
            await github.rest.issues.addAssignees({
              owner, repo, issue_number,
              assignees: [author],
            });

            core.info(`âœ… @${author} ë‹˜ì„ #${issue_number} ì´ìŠˆì˜ ë‹´ë‹¹ìë¡œ ì§€ì • ì™„ë£Œ`);

            await github.rest.issues.createComment({
              owner, repo, issue_number,
              body: `âœ… @${author} ë‹˜ì„ #${issue_number} ì´ìŠˆì˜ ë‹´ë‹¹ìë¡œ ìë™ ì§€ì •í–ˆì–´ìš”!`
            });
